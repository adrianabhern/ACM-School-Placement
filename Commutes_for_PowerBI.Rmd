```{r setup, include=FALSE}
library(dplyr)
library(tidyr)
library(readxl)
library(gmapsdistance)

root_dir = "C:\\Users\\aperusse\\GitHub\\ACM-School-Placement\\"
api = "AIzaSyDQh2XWQHdWxfGOpNSDzD4pGb3UMCSV6TE"

# acm_df <- dataset
acm_df <- read_excel(path = paste(root_dir, "Input 1 - LA ACM Data.xlsx", sep = "")) %>%
            filter(is.na(Manual.Placement), !is.na(Res.Postal.Code)) %>%
            mutate(Res.Postal.Code = as.character(Res.Postal.Code))
school_df <- read_excel(path = paste(root_dir, "Input 3 - LA School Data.xlsx", sep = ""))

acm_df$Travel.Method <- "driving"

# Replace spaces with "+" and remove commas (requests to google maps API cannot include spaces)
school_df$Address = gsub(" ", "+", school_df$Address)
school_df$Address = gsub(",", "", school_df$Address)

# Set api key
set.api.key(api)

# feed that ACM's address and mode into the function 'gmapsdistance'. This will return a new object that is a sngle row of ACM commute times to each school. That row is assigned to a new object, 'commute'
commute <- gmapsdistance(origin = acm_df$Res.Postal.Code, 
                          destination = school_df[school_df$sch_id %in% c(1:30), ]$Address, 
                          mode = "driving", 
                          combinations = "all", 
                          shape = "long")


# Write to .csv, which will be referenced by main algorithm

write.table(acm_commutes, file = paste(root_dir, "ACM_Commutes.csv", sep = ""), sep=",", row.names=FALSE)

```